---
title: "Taller 1 en grupo"
author: "Alejandro Bedoya Taborda\nAngie Melissa Montoya Urrego\nCristian Camilo Henao Rojas\nMariana Arias Montoya\nLuis Felipe Marin Buitrago"
date: "17/9/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)
```


```{r}
#librerias
library(knitr)
library(ggplot2)
library(RColorBrewer)
library(fmsb) #Librería para la araña
library(sqldf) #Librería sql

#lectura de la base de datos.
encuesta_habitos <- read.csv2("Encuesta_habitos.csv", 
                       encoding = "UTF-8",
                       dec = ".")
```

# Genero

#### Tabla de frecuencia.

```{r}
#tabla de frecuencias de género.
genero <- table(encuesta_habitos$genero)
genero
genero_porcentaje <- round(genero / sum(genero)*100,2)
```

#### Grafica.
```{r}
#Trabajamos el lienzo
par(mar = c(8, 5, 3, 3))# le damos margenes
plot(seq(0,3,length.out = 100), 1:100, 
     type = "n",
     main = "Genero",
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3)
g1 <- barplot(genero_porcentaje,
        col = c("#d9ae94", "#f1dca7"),
        cex.names = 0.65,
        las=1,
        add = TRUE,
)
text(g1, c(30,78), 
     labels = paste(formatC(genero_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```


# Fecha de nacimiento {.tabset}

## Gráfica
```{r}

fechas<- as.Date(encuesta_habitos$fecha_dep,"%d/%m/%Y")
fec_table<-table(format(fechas,"%Y"))
e<-kable(fec_table, col.names = c('Año','Frecuencia'), align = 'lc')

ggplot(encuesta_habitos, aes(x=seq(0,100,length.out = 132),y=as.numeric(format(fechas,"%Y")))) + 
    geom_boxplot(fill="slateblue", alpha=0.4) + theme_bw()+
    xlab("")+ylab('Año')+ggtitle('Boxplot de la variable Años')+theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5)) + coord_cartesian(ylim = c(1956,2020)) + scale_y_continuous(breaks = seq(1950,2020,5)) + theme(axis.text.x = element_blank(),axis.ticks.x = element_blank(),axis.title.y = element_text(size = 15, vjust = 1.3), axis.text.y = element_text(family = "Helvetica", face = "bold", size = (10)))
 ggplot(encuesta_habitos, aes(x=seq(0,100,length.out = 132),y=as.numeric(format(fechas,"%Y")))) + 
    geom_violin(fill="slateblue", alpha=0.4) + theme_bw()+
    xlab("")+ylab('Año')+ggtitle('Violín de la variable Años')+theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5)) + coord_cartesian(ylim = c(1956,2020)) + scale_y_continuous(breaks = seq(1950,2020,5)) + theme(axis.text.x = element_blank(),axis.ticks.x = element_blank(),axis.title.y = element_text(size = 15, vjust = 1.3), axis.text.y = element_text(family = "Helvetica", face = "bold", size = (10)))
```


## Resumen numerico

```{r}
summary(as.numeric(format(fechas,"%Y")))
```

## Tabla de frecuencia
```{r}
e
```

## Grafica Dias
```{r}
dtable<- format(fechas,'%d')
dias<- as.vector(table(dtable))
dias<-append(dias,0,after = 2)
df<- data.frame('dias'= dias)
dtable1<-sort(unique(c(dtable,'03')))
ggplot(df,aes(x=dtable1,y=dias))+geom_segment(aes(x=dtable1,xend=dtable1,y=0,yend=dias), color='grey70',lwd=1)+theme_light() + scale_y_continuous(breaks = seq(0,15,1))+ggtitle('Lollipop de la variable Días' ) +
  theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5),axis.title.x = element_text( size = (15)), axis.text.y = element_text(family = "Helvetica", face = "bold", size = (10)),axis.text.x = element_text(family = "Helvetica", face = "bold", size = (10)),axis.title.y = element_text(size = 15),panel.grid.major.x = element_blank(),panel.border = element_blank(),axis.ticks.x = element_blank())+ylab('Número de personas')+ xlab('Día de cumpleaños' )+ geom_point(color="brown", size=3)
```

# Edad {.tabset}

## Grafica

```{r}
fechadepu<- fechas
fechadepu<-fechadepu[!format(fechadepu,"%Y") %in% as.character(seq(2005,2020,1))]
edad<-round(as.numeric(Sys.Date() - fechadepu )/ 365,0)
ggplot(as.data.frame(edad), aes(x=seq(0,100,length.out = 125),y=edad)) + 
    geom_boxplot(fill="darkorange", alpha=0.4) + theme_grey()+
    xlab("")+ylab('Años')+ggtitle('Boxplot de la Edad')+theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5)) + coord_cartesian(ylim = c(15,70)) +scale_y_continuous(breaks = seq(15,70,5)) + theme(axis.text.x = element_blank(),axis.ticks.x = element_blank(),axis.title.y = element_text(size = 15, vjust = 1.3), axis.text.y = element_text(family = "Helvetica", face = "bold", size = (10)))
ggplot(as.data.frame(edad), aes(x=seq(0,100,length.out = 125),y=edad)) + 
    geom_violin(fill="darkorange", alpha=0.4) + theme_grey()+
    xlab("")+ylab('Años')+ggtitle('Violín de la Edad')+theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5)) + coord_cartesian(ylim = c(15,70)) + scale_y_continuous(breaks = seq(15,70,5)) + theme(axis.text.x = element_blank(),axis.ticks.x = element_blank(),axis.title.y = element_text(size = 15, vjust = 1.3), axis.text.y = element_text(family = "Helvetica", face = "bold", size = (10)))
```

## Resumen numérico
```{r}
summary(edad)
 
```
#### Análisis descriptivo:

Del gráfico se observa la distribución porcentual de los estudiantes por genero. Se observa que la cantidad de personas que pertenecen al genero masculino es evidentemente mayor a la cantidad de personas del genero fememino, esto es con una diferencia del 46.96% entre ambos generos. 

# Carrera

```{r}
carrera <- table(encuesta_habitos$carrera_dep)
carrera
carrera_porcentaje <- round(carrera/sum(carrera) * 100,2)
```


```{r}
#Trabajamos el lienzo
par(mar = c(10, 8, 3, 3))# le damos margenes
plot(seq(0,10,length.out = 100), 1:100, 
     type = "n",
     main = "Carrera",
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3)
g2 <- barplot(carrera_porcentaje,
        col = c("#d9ae94", "#f1dca7"),
        las=1,
        names.arg = "",
        add = TRUE,
)
text(g2, c(60,10,8,8,45,10,10,8), 
     labels = paste(formatC(carrera_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
text(g2 + 0.2,
    par("usr") [3], 0.4,
    labels = names(carrera),
    srt = 45,
    pos = 2,
    cex = 0.60,
    xpd = TRUE)
```

#### Análisis descriptivo:

En este gráfico se observa la distribución porcental de los estudiantes por carrera. Se puede notar que apróximadamente el 90% de los estudiantes pertenecen a las carreras de Estadística e ingeniería de sistemas e informática y con menos frecuencia se encuentran las carreras de ingeniería biológica e ingeniería de control.

# PAPA {.tabset}
## Grafica
```{r}
p<- sort(encuesta_habitos$PAPA)
frecpapa<-as.vector(table(p))
p<-unique(p)
dfpapa<- data.frame(papa=p,frecuencia=frecpapa)
ggplot(encuesta_habitos, aes(encuesta_habitos$PAPA))+ geom_freqpoly(bins=20,color='mediumvioletred',lwd=1)+ ggtitle('Polígono de Frecuencia del PAPA')+ scale_y_continuous(breaks = seq(0,20,2)) + ylab('Frecuencia')+xlab('P.A.P.A')+ theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5))+ theme(axis.ticks.x = element_blank(),axis.text.x = element_text(family = "Helvetica", face = "bold", size = (10)),axis.text.y = element_text(family = "Helvetica", face = "bold", size = (10)), axis.title.x = element_text(size = 15),axis.title.y = element_text(size = 15))
```


## Tabla de Frecuencia
```{r}
kable(table(encuesta_habitos$PAPA), col.names = c('PAPA','Frecuencia'), align = 'cc')
```

# Estrato

```{r}
estrato <- table(encuesta_habitos$estrato)
estrato
estrato_porcentaje <- round(estrato/sum(estrato)*100,2)
```


```{r}
#Trabajamos el lienzo
par(mar = c(8, 5, 3, 3))# le damos margenes
plot(seq(0,7,length.out = 100), 1:100, 
     type = "n",
     main = "Estrato",
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3)
g1 <- barplot(estrato_porcentaje,
        col = c("#d9ae94", "#f1dca7"),
        cex.names = 0.65,
        las=1,
        add = TRUE,
)
text(g1, c(8,20,40,50,12,8), 
     labels = paste(formatC(estrato_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```
#### Análisis descriptivo:

Del gráfico se observa la distribución porcentual de los estudiantes por estrato. Se puede evidencia que aproximadamente el 78% de los estudiantes pertenecen a los estratos 2 y 3.



# Computador de mesa:

```{r}
computador_mesa <- table(encuesta_habitos$computador_mesa)
computador_mesa
computador_mesa_porcentaje <- round(computador_mesa/sum(computador_mesa)*100,2)
```

```{r}
#Trabajamos el lienzo
par(mar = c(8, 5, 3, 3))# le damos margenes
plot(seq(0,5,length.out = 100), 1:100, 
     type = "n",
     main = "Computador de mesa",
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3)
g1 <- barplot(computador_mesa_porcentaje,
        col = c("#d9ae94", "#f1dca7"),
        cex.names = 0.65,
        las=1,
        add = TRUE,
)
text(g1, c(75,8,8,35), 
     labels = paste(formatC(computador_mesa_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```
#### Análisis descriptivo:

De este gráfico claramente se observa la distribución porcentual de los estudiantes respecto a si poseen o no computador de mesa. En caso de tenerlo, si es prestado, alquilado o propio. 
Según lo que vemos en la gráfica podemos concluir que casi el 70% de los estudiantes no tienen un computador de mesa.


# Portatil


```{r}
portatil <- table(encuesta_habitos$portatil)
portatil
portatil_porcentaje <- round(portatil/sum(portatil)*100,2)
```

```{r}
#Trabajamos el lienzo
par(mar = c(8, 5, 3, 3))# le damos margenes
plot(seq(0,5,length.out = 100), 1:100, 
     type = "n",
     main = "Portatil",
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3)
g1 <- barplot(portatil_porcentaje,
        col = c("#d9ae94", "#f1dca7"),
        cex.names = 0.65,
        las=1,
        add = TRUE,
)
text(g1, c(18,8,16,78), 
     labels = paste(formatC(portatil_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```
#### Análisis descriptivo:

En este gráfico se observa la distribución porcental de los estudiantes respecto a si poseen o no computador portatil. En caso de tenerlo, si es prestado, alquilado o propio.
Claramente se observa que aproximadamente el 73% de los estudiantes tienen un computador portatil propio.

# Internet

```{r}
internet <- table(encuesta_habitos$internet)
internet
internet_porcentaje <- round(internet/sum(internet)*100,2)
```

```{r}
#Trabajamos el lienzo
par(mar = c(8, 5, 3, 3))# le damos margenes
plot(seq(0,7,length.out = 100), 1:100,
     type = "n",
     main = "Internet",
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3) # las lineas que señalan las gráficas.
g1 <- barplot(internet_porcentaje,
        col = c("#d9ae94", "#f1dca7"), #Colores de la gráfica
        cex.names = 0.65,#tamaño del nombre
        las=1, #Posición de los nombres
        add = TRUE, # se agrega para poder poner encima de un plot.
)
# Con las siguientes líneas se trabajan los porcentajes encima de la barra.
text(g1, c(10,8,10,10,38,60), #Aquí pueden modificar las alturas.
     labels = paste(formatC(internet_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```
#### Análisis descriptivo: (pendiente)

# Smartphone


```{r}
smartphone <- table(encuesta_habitos$smartphone)
smartphone
smartphone_porcentaje <- round(smartphone/sum(smartphone)*100,2)
```



```{r}
#Trabajamos el lienzo
par(mar = c(5, 5, 3, 3))# le damos margenes
plot(seq(0,5,length.out = 100), 1:100,
     type = "n",
     main = "Smartphone", 
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3) # las lineas que señalan las gráficas.
g1 <- barplot(smartphone_porcentaje,
        col = c("#d9ae94", "#f1dca7"), #Colores de la gráfica
        cex.names = 0.65,#tamaño del nombre
        las=1, #Posición de los nombres
        add = TRUE, # se agrega para poder poner encima de un plot.
)
# Con las siguientes líneas se trabajan los porcentajes encima de la barra.
text(g1, c(6,6,10,102), #Aquí pueden modificar las alturas.
     labels = paste(formatC(smartphone_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```

# Origen  del Covid-19 {.tabset}

## Distribución porcentual
```{r}
a<-encuesta_habitos$origen_covid_19
a<-gsub('\\<Es.*n[[:punct:]]','Conspiracion',a)
a<-gsub('\\<Fue[[:blank:]]fabricado.*rio[[:punct:]]','Laboratorio',a)
a<-gsub('\\<Fue.*nos[[:punct:]]','Animales',a)
a<-gsub('\\<No.*do[[:punct:]]','Gobiernos',a)
a<-gsub('\n',', ',a)
aporc<-round(table(a)/sum(table(a))*100,1)
q<-as.data.frame(sort(table(a),decreasing = TRUE))

palets<- brewer.pal(8,"Set2")
pie(sort(aporc,decreasing = TRUE),main='Causas del Covid-19',col=palets, border = 'white',lty=1,radius = 1,labels = '')
legend(1,0,legend = paste(as.character(sort(aporc,decreasing = TRUE)),'%'),pch=15,col=palets,cex = .7)
legend(-2,1,legend = q$a ,pch=15,col=palets,cex = .7)
kable(round(sort(table(a),decreasing = TRUE)/sum(table(a))*100,1),col.names = c('Causa','porcentaje'))

```


## Grafica
```{r}
q<-as.data.frame(table(a))
ggplot(q,aes(x=q$Freq,y=q$a)) + geom_bar(stat = "identity", col='darkslategray3',fill='darkslategray3',alpha=.7)+scale_x_continuous(breaks = seq(0,80,5)) + ylab('Causa')+xlab('Número de personas')+ ggtitle('Causas del Covid-19')+theme(
  panel.grid.minor.y = element_blank(),panel.grid.minor.x = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_text(size=15, vjust = -.5), axis.title.y = element_text(size = 15,vjust = 3),axis.text = element_text(family = "Helvetica", face = "bold", size = (10)),plot.title = element_text(family = "Helvetica", face = "bold", size = (20),hjust = .5)
)
```






#### Análisis descriptivo:

Del gráfico se muestra la distribución porcentual de los estudiantes respecto a si poseen o no un smartphone. En caso de tenerlo, si es prestado, alquilado o propio. Se observa claramente que un aproximado del 97% de los estudiantes tienen un smartphone propio. 

# Estadisticas gov

```{r}
gobierno <- table(encuesta_habitos$estad_gov)
gobierno
```

```{r}
gobierno_porcentaje <- round(gobierno/sum(gobierno)*100,2)
gobierno_porcentaje
```

```{r}
#Trabajamos el lienzo
par(mar = c(5, 5, 3, 3))# le damos margenes
plot(seq(0,5,length.out = 100), 1:100,
     type = "n",
     main = "Estadistica del gobierno.", 
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3) # las lineas que señalan las gráficas.
g1 <- barplot(gobierno_porcentaje,
        col = c("#d9ae94", "#f1dca7"), #Colores de la gráfica
        cex.names = 0.65,#tamaño del nombre
        las=1, #Posición de los nombres
        add = TRUE, # se agrega para poder poner encima de un plot.
)
# Con las siguientes líneas se trabajan los porcentajes encima de la barra.
text(g1, c(78,30), #Aquí pueden modificar las alturas.
     labels = paste(formatC(gobierno_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```
#### Análisis descriptivo:

Como se puede evidenciar en la gráfica, aproximadamente el 75% de los estudiantes se muestran escépticos frente a los datos y las estadísticas que emite el gobierno nacional durante el desarrollo de la pandemia en Colombia.

# Habitos de estudio(PENDIENTE):

# Número aleatorio.

```{r}
aleatorio <- table(encuesta_habitos$aleatorio)
aleatorio
```

```{r}
aleatorio_porcentaje <- round(aleatorio/sum(aleatorio)*100,2)
aleatorio_porcentaje
```

```{r}
#Trabajamos el lienzo
par(mar = c(5, 5, 3, 3))# le damos margenes
plot(seq(0,13,length.out = 100), 1:100,
     type = "n",
     main = "Número aleatorio", 
     cex.main = 0.75,
     axes = FALSE,
     xlab = "",
     ylab = "Porcentajes"
     )
abline(h = seq(0,100,10), col = "gray", lty = 3) # las lineas que señalan las gráficas.
g1 <- barplot(aleatorio_porcentaje,
        col = c("#d9ae94", "#f1dca7"), #Colores de la gráfica
        cex.names = 0.60,#tamaño del nombre
        las=1, #Posición de los nombres
        add = TRUE, # se agrega para poder poner encima de un plot.
)
# Con las siguientes líneas se trabajan los porcentajes encima de la barra.
text(g1, c(8,10,12,10,4,14,16,10,30,18), #Aquí pueden modificar las alturas.
     labels = paste(formatC(aleatorio_porcentaje,
                            digits = 6, decimal.mark = ",", 
                            big.mark = "."), "%"))
```
#### Análisis descriptivo: (pendiente).


# PAPA-Género

```{r}

#Tabla de frecuencias del papa por genero
papaxgenero <- table(encuesta_habitos$genero, encuesta_habitos$PAPA)
#Data frame para poder ingresar a la gráfica
total <- data.frame(papaxgenero)
#Gráfica
ggplot(total, aes(fill=Var1, x=Var2, y=Freq))+
  geom_bar(position="dodge",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Genero", title="PAPA discriminado por género")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)#Lineas punteadas en cada unidad
```

# PAPA-Edad

```{r}
#Se seleccionan las fechas de nacimiento y los papas sin NA 
papaedad <- sqldf('SELECT fecha_dep,PAPA FROM encuesta_habitos WHERE PAPA IS NOT NULL')
#Se tratan ls fechas de nacimiento para sacar la edad
papaedad$fecha_dep <- as.Date(papaedad$fecha_dep,"%d/%m/%Y")
papaedad$fecha_dep <- round(as.numeric(Sys.Date() - papaedad$fecha_dep )/ 365,0)
#Se seleccionan las edades con sentido
papaedad <- sqldf('SELECT * FROM papaedad WHERE fecha_dep>1')
#Se cuentan las edades por papa ej: con el papa 3.0 hay 2 personas de 20 años, 1 de 17 años, etc
tablaedadpapa <- sqldf('SELECT fecha_dep, PAPA, COUNT(*) as Cuantos FROM papaedad GROUP BY fecha_dep, PAPA')
#Se convierte la edad en un factor para graficar mejor
tablaedadpapa$fecha_dep <- as.factor(tablaedadpapa$fecha_dep)
#Grafica
ggplot(tablaedadpapa, aes(fill=fecha_dep, x=PAPA, y=Cuantos))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Edad", title="PAPA discriminado por Edad")+ 
  theme(legend.title = element_blank())
```

# PAPA-Carrera

```{r}

#Query en sql para poder sacar datos necesarios para graficar
query <- sqldf('SELECT carrera_dep,AVG(PAPA) from encuesta_habitos GROUP BY carrera_dep')
#Lastimosamente no supe como automatizar para que quede organizado para graficar
#Pero usé la información dada para hacer el data frame a mano
#Data frame a mano
para_graficar <- data.frame(3.7,3.6,3.4,3.5,3.7,3.6,4.1,4.0)
#Nombre de las columnas del data frame
colnames(para_graficar) <- c("Estadistica","Ing administrativa","Ing biologica","Ing de control","Ing de sistemas e informatica","Ing fisica"," Ing industrial","Matematicas")
#Se debe poner cuál es el valor minimo y maximo que puede alcanzar la grafica
para_graficar <- rbind(rep(5,8) , rep(3,8) , para_graficar)
#Grafica
radarchart(para_graficar,axistype=1 , 
 
    #Poligono interno
    pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) , plwd=4 , 
 
    #Malla
    cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(3,5,0.5), cglwd=0.8,
 
    #Etiquetas o labels
    vlcex=0.8, title=paste("Promedio del PAPA por carrera"), cex.main=1 )
```

# PAPA-Estrato

```{r}
#Tabla del papa segun el estrato
papaxes <- table(encuesta_habitos$PAPA, encuesta_habitos$estrato)
#Se debe convertir la tabla en un data frame para poder graficar
graf0 <- data.frame(papaxes)
#Grafica
ggplot(graf0, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Estrato", title="PAPA discriminado por Estrato")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)#Lineas punteadas en cada unidad
```


# PAPA-Computador de mesa

```{r}
#Tabla del papa segun el computador de mesa
papaxpc <- table(encuesta_habitos$PAPA, encuesta_habitos$computador_mesa)
#Se debe convertir la tabla en un data frame para poder graficar
graf <- data.frame(papaxpc)
#Grafica
ggplot(graf, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Computador", title="PAPA discriminado por Computador")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)#Lineas punteadas en cada unidad
```

# PAPA-Portatil

```{r}
#Igual al anterior
papaxpr <- table(encuesta_habitos$PAPA, encuesta_habitos$portatil)
graf2 <- data.frame(papaxpr)
ggplot(graf2, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Portatil", title="PAPA discriminado por Portatil")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)
```

# PAPA-Internet

```{r}
#Igual al anterior
papaxin <- table(encuesta_habitos$PAPA, encuesta_habitos$internet)
graf3 <- data.frame(papaxin)
ggplot(graf3, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Internet", title="PAPA discriminado por Internet")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)
```

# PAPA-Smartphone

```{r}
#Igual al anterior
papaxsp <- table(encuesta_habitos$PAPA, encuesta_habitos$smartphone)
graf4 <- data.frame(papaxsp)
ggplot(graf4, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+labs(x="PAPA",y="Número de personas",fill = "Smartphone", title="PAPA discriminado por Smartphone")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)
```

# PAPA-Origen del COVID-19

```{r}
#Igual al anterior
papaxcovid <- table(encuesta_habitos$PAPA, encuesta_habitos$origen_covid_19)
graf5 <- data.frame(papaxcovid)
ggplot(graf5, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Origen COVID-19", title="PAPA discriminado por Origen COVID-19")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)+ 
  scale_fill_brewer(palette = "Set3")+
  theme(plot.margin= unit(c(0,0,0,0),"cm"),legend.text=element_text(size=6.5))
#El theme ajusta el tamaño de la leyenda y las margenes
```

# PAPA-Estadisticas del gobierno

```{r}
#Igual que el anterior
papaxstats <- table(encuesta_habitos$PAPA, encuesta_habitos$estad_gov)
graf6 <- data.frame(papaxstats)
ggplot(graf6, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Estadisticas del gobierno", title="PAPA discriminado por Estadisticas del gobierno")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)+ 
  scale_fill_brewer(palette = "Set3")#Colores
```

# PAPA-Hábitos

PENDIENTE

# PAPA-Aleatorio

```{r}
#Igual que los anteriores
papaxal <- table(encuesta_habitos$PAPA, encuesta_habitos$aleatorio)
graf7 <- data.frame(papaxal)
ggplot(graf7, aes(fill=Var2, x=Var1,  y=Freq))+
  geom_bar(position="stack",stat="identity")+
  labs(x="PAPA",y="Número de personas",fill = "Número", title="PAPA discriminado por número aleatorio")+
  geom_hline(yintercept = 0:20, color="gray",linetype="dashed", size=0.2)+ 
  scale_fill_brewer(palette = "Spectral")#Colores
```